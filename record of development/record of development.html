<html>
	<head>
		<meta charset="ISO-8859-1">
		<style>
			div{
				width: 512px;
				padding: 10px;
				border-color: black;
				border-width: 1px;
				border-style: solid;
			}
			div.comment{
				width: 490px;
				border-style: none;
				background-color: #EEEEEE;
			}
			img{
				width: 512px;
			}
			img.half-width{
				width: 250px;
			}
			p.date{
				color: #888888;
			}
			a{
				color: #0000ff;
			}
		</style>
	</head>

	<body>
		<div>
			<p>
				<h2>First revision of circuit</h2>
			</p>
			<p class="date">
				25/11/2020
			</p>
			<p>
				Using the open-source circuit design tool "KiCAD", I have designed the block diagram of the circuit which will allow an Arduino to communicate with an IMU.
			</p>
			<p>
				<img src="initial circuit.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/initial%20circuit.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Issue with the first revision</h2>
			</p>
			<p class="date">
				26/11/2020
			</p>
			<p>
				The IMU used in the first revision design is no longer avaliable from the original supplier and will need to be replaced or found from a different supplier.
			</p>
			<p>
				<h2>Reseraching alternate chips</h2>
			</p>
			<p>
				I have researched a number of alternative options for the IMU and found two suitable ICs that are in resonable stock from the original supplier. These ICs have similar capabilities to the original IC, though are slightly newer designs.
			</p>
			<p>
				<h2>Second revision of circuit</h2>
			</p>
			<p>
				I have made a new revision of the circuit that makes use of one of the new ICs that are currently in stock. My next steps will be considering how the IC will communicate with the Arduino and how to supply power to the IC according to its datasheet
			</p>
			<p>
				<h2>Second revision of circuit completed</h2>
			</p>
			<p>
				I have added the required connections for communication and components for the voltage supply to the IC.
			</p>
			<p>
	    		<img src="second circuit 2.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/second%20circuit%202.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Second revision components arrived</h2>
			</p>
			<p class="date">
				14/12/2020
			</p>
			<p>
				I have received the components from the supplier and constructed the circuit. The IMU connects to the Arduino via I2C and uses the Arduino's regulated voltage supply for power.
			</p>
			<p>
				The IMU is smaller than expected, making it very fragile. This made it very difficult to solder to as there are 12 pins within a 2mm by 2mm area, of which most need to be connected.
			</p>
			<p>
				<img src="spider 1.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/spider%201.png?raw=true';">
			</p>
			<p>
				After managing to connect the IMU to the Arduino and the Arduino then to a computer, I have read back some of the data from the IMU before one of the critical pads fell off the IC.
			</p>
			<p>
				The difficulty in soldering and the lack of any larger components being avaliable has resulted in the decision to design a PCB and have it printed. This will improve the durability of the circuit and ensure that it doesn't come appart.
			</p>
			<p>
				<h2>Third revision of circuit</h2>
			</p>
			<p>
				I have designed a third revision of the circuit using separate ICs for the acceleromter and gyroscope. This has vastly increased the complexity of the PCB as there are a number of communication traces which must be routed around each other.
			</p>
			<p>
	    		<img src="third circuit.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/third%20circuit.png?raw=true';">
			</p>
			<p>
				The block diagram of the circuit will need to be turned into a layout that can then be printed. The use of breadboard pins on the PCB will simplify the connecting of the PCB to an Arduino.
			</p>
		</div>

		<div>
			<p>
				<h2>Third revision of circuit completed</h2>
			</p>
			<p>
				19/12/2020
			</p>
			<p>
				<img src="render.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/render.png?raw=true';">
			</p>
			<p>
				This version makes use of independent gyroscope and accelerometers which increases the complexity of the design. I have produced the Gerber file for the layout of the PCB and the BOM for the required components. These will need to be sent to a PCB manufacture to be produced.
			</p>
			<p>
	    		<img src="layout.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/layout.png?raw=true';">
			</p>
			<p>
				I have also cleaned up the block diagram of the circuit to make it easier to read and debug later if there are any issues.
			</p>
		</div>

		<div>
			<p>
				<h2>Unable to get the components</h2>
			</p>
			<p class="date">
				18/1/2020
			</p>
			<p>
				One of the components required for the third revision of the design is not avaliable from the PCB manufacture I have been looking at. This will require either looking at another manufacure or redesigning for another component. I will redesign to remove the reliance on two independent ICs as this will reduce the complexity of the project in the software stage and also in the the layout of the PCB.
			</p>
		</div>

		<div>
			<p>
				<h2>Changing the IC(s)</h2>
			</p>
			<p class="date">
				26/1/2021
			</p>
			<p>
				With the lack of options and stock from the original PCB mnanufacture, I have researched other manufacures, though the shortage appears to be global currently. However, I have found a manufacture which allows the use of any components from a bulk re-saler that has stock of almost all components.
			</p>
			<p>
				The components in the third revision appear to have been superceeded and are no longer avaliable. I have researched other options and designed a fourth revision of the circuit using a new IMU that is the latest in lower power technology and accuracy. This will make it more complicated to use as it is a 1.8V product, but should be more accurate than the alternatives.
			</p>
		</div>

		<div>
			<p>
				<h2>Fourth revision of circuit</h2>
			</p>
			<p class="date">
				28/1/2021
			</p>
			<p>
				I have redesigned the circuit to use the new low power IC and used to datasheet to connect the pins that I will need access to. The new IC is slightly smaller than even one of the previous ICs, making the new PCB much smaller.
			</p>
			<p>
				<h2>Fourth revision completed</h2>
			</p>
			<p>
				I have finished the block diagram of the new circuit, selected the components for the PCB and created a BOM for it. I then uploaded the BOM to the manufacture's website to check avaliability of the components. I modified the Python script used to produce the BOM to fit the format required by the site.
			</p>
			<p>
	    		<img src="final circuit.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/final%20circuit.png?raw=true';">
	        </p>
			<p>
				All the components are currently avaliable through PCBTrain, an online PCB manufacturer.
			</p>
			<img src="part list 3.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/part%20list%203.png?raw=true';">
		</div>

		<div>
			<p>
				<h2>System overview concept</h2>
			</p>
			<p class="date">
				I have compiled my research into the theory behind the system and colated it to consider the areas that I still needed consider. This helped me to spot any areas that would be more compicated and reads that I didn't have sufficient research to resovle. This compilation has also made me more familiar to the concepts, which will make it eaasier to start writing the required software.
			</p>
			<p>
				<span>Areas I have covered include:</span>
				<ul>
					<li>Torque</li>
					<li>Angular momentum</li>
					<li>Moments of interia</li>
					<li>Solving for corrections using the thrust values</li>
				</ul>
			</p>
		</div>

		<div>
			<p>
				<h2>I2C communication</h2>
			</p>
			<p class="date">
				11/3/2021
			</p>
			<p>
				I have installed and setup an environment in which to develop and deploy Arduino code to an Arduino to test the components required. I began this by researching and implemeting I2C communication of the Arduino; I wrote a simple sketch in which the communication line is initiallised and a transmission is conducted over the connection. I do not currently have any way of testing this code yet.
			</p>
		</div>

		<div>
			<p>
				<h2>Testing the fourth revision</h2>
			</p>
			<p class="date">
				16/3/2021
			</p>
			<p>
				The PCBs have arrived from the manufacture. I can now start to work on testing these and integrating them with the software. The PCBs fit into the breadboard with the Arduino and I used a 22 gauge solid core wire to connect the two together.
			</p>
			<p>
				<img src="circuit.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/circuit.png?raw=true';">
			</p>
			<p>
				Using a multimeter, I check the voltages around the PCB to ensure that they were as expected. The supply voltage was reading back very low, so I increased the voltage at the top of the potential divider to try increase the supply voltage, which seemed to fix the issue.
			</p>
			<p>
				<h2>Reading the first register</h2>
			</p>
			<p>
				With the circuit connected to the Arduino, I used the I2C code I had already written to read the value back from the WHO_AM_I register which readback the correct value. However, the dynamic values from the sensors remained null.
			</p>
			<p>
				<img src="reading WHO_AM_I.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/reading%20WHO_AM_I.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Unable to read data registers</h2>
			</p>
			<p class="date">
				18/3/2021
			</p>
			<p>
				At first I assumed the issue was with the votlage supply to the IC not being high enough, being too high or simply fluctuating too much. Solving this would require another redesign to add either a different voltage regulation method, or to add more capcitance between the supply and ground.
			</p>
			<p>
	    		<img src="no IMU data.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/no%20IMU%20data.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Voltage level shifter</h2>
			</p>
			<p class="date">
				11/4/2021
			</p>
			<p>
				Having assumed that the issue was with feedback from the supply voltage from the Arduino and the communication lines causing invalid voltages being seen by the IC, I have researched, designed and made a voltage level shifter that should be able to solve the problem.
			</p>
			<p>
				<img src="transistors.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/transistors.png?raw=true';">
			</p>
			<p>
				I started with a naive solution using four transistors in a loop to isolate each side and allow bi-directional communication. However, this design did not function as I had hoped. I tested each side of the shifter separately and found that they worked when independent from each other using an oscilloscope to view the output of the circuit. I discovered an issue with one of the resistors being the incorrect value, though fixing this had no bearing on the result of the test.
			</p>
			<p>
				<img src="trying the square.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/trying%20the%20square.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Changing to MOSFETs</h2>
			</p>
			<p class="date">
				18/4/2021
			</p>
			<p>
				With the loop of BJT transistors being non-functional, I have returned to my research into the topic and found a diagram that makes use of MOSFETs to connect the two voltage levels. This method should work bi-directionally and only require one component per signal line.
			</p>
		</div>

		<div>
			<p>
				<h2>MOSFETs installed</h2>
			</p>
			<p class="date">
				21/4/2021
			</p>
			<p>
				I have remade the circuit using the MOSFETs and communicaiton between the Arduino and IMU functions correctly on static registers, though the same null values as before are seen in the sensors' dynamic register.
			</p>
			<p>
				<img src="mosfets installed.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/mosfets%20installed.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>A possible break through</h2>
			</p>
			<p class="date">
				22/4/2021
			</p>
			<p>
				I have discovered a line in the datasheet of the IMU that describes a register that must be set to move out of sleep mode and start the sensors. This explains the null data and also suggests that the setup I had before would have funcitoned just as well.
			</p>
			<p>
				<img src="sleep mode.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/sleep%20mode.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Not quite that simple</h2>
			</p>
			<p class="date">
				27/4/2021
			</p>
			<p>
				The fix to the sleep mode has not worked as I expected and has instead reduced the number of bytes I can read in any one go. I can now read and write to the registers however, so the MOSFET version is the most successful yet. The WHO_AM_I register continues to return the correct value.
			</p>
		</div>

		<div>
			<p>
				<h2>Digital oscilloscope</h2>
			</p>
			<p class="date">
				28/4/2021
			</p>
			<p>
				I have been looking into getting access to a digital oscilloscope to check that he I2C communicatin is happening as I expect. While it is likely that this is functioning correctly, it is one of the few things I have yet to check.
			</p>
			<p>
				I have been unable to get access to a digital oscilloscope, so will need to assume that the I2C works and eleminate this variable some other way.
			</p>
		</div>

		<div>
			<p>
				<h2>New inspirations for the software</h2>
			</p>
			<p class="date">
				6/5/2021
			</p>
			<p>
				I have found a GitHub repositary and issue thread that document an commertial breadout board for the IMU I am using. I have tried this code with my PCB and found that it doesn't work either.
			</p>
		</div>

		<div>
			<p>
				<h2>Eleminating variables</h2>
			</p>
			<p class="date">
				10/5/2021
			</p>
			<p>
				Haing tried a number of different example softwares for the IMU, I have purchaced one of the commertial breakout boards for to eleminate this final variable. I have also tired the fourth revision PCB with two three different Arduino Nano's and an Arduino Every, none of which are able to get it to funciton.
			</p>
			<p>
				<img src="Arduino Every.png" style="width:425px" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/Arduino%20Every.png?raw=true';">
			</p>
		</div>

		<div>
			<p>
				<h2>Pre-made PCB</h2>
			</p>
			<p class="date">
				12/5/2021
			</p>
			<p>
				I receive the pre-made PCB from Adafruit and have modified their example software to suit the outputs I need. The code prints the data form the sensors correctly.
			</p>
			<p>
			    <img src="Every with pre-made.png" onerror="this.onerror=null;this.src='https://github.com/TommyGymer/TVC-system/blob/main/record%20of%20development/Every%20with%20pre-made.png?raw=true';">
			</p>
			<p>
				I have written a program in Processing to process the data and turn it into rotations and movements for a cube. I will need to add a velocity display to this program. I might revist the fourth revision PCB if I find time.
			</p>	
		</div>

		<div>
			<p>
				<h2>Using GitHub</h2>
			</p>
			<p class="date">
				27/5/2021
			</p>
			<p>
				I have setup a GitHub repository to store and version the code I have written. This will allow me to revert to funcitonal versions and document any changes that I make.
			</p>
			<p>
				The GitHub page is available at "github.com/TommyGymer/TVC-System". This is where I have stored all of the code used in this project and also logged all of the code changes beyond those that I felt where large enough for their own record entry.
			</p>
			<p>
				I am using GitHub for its accessibility, ease of use and also wide spread use in the devlopement indeustry.
			</p>
			<p>
				<h2>Progress with data from the IMU</h2>
			</p>
			<p>
				With the pre-made PCB, I have been able to pull the required data and read the data using a connected computer. I have been able to translate this data to a cube, though the movement did not sync with what was actually happening.
			</p>
			<p>
				I have corrected a number of bugs in the software and am now able to observe the movement, though the measurements drift overtime and will need to be filtered in some way to correct for this.
			</p>
		</div>

		<div>
			<p>
				<h2>Progress with the data from the IMU</h2>
			</p>
			<p class="date">
				27/5/2021	11:44PM
			</p>
			<p>
				<span>With the new pre-made PCB, I have been able to sucessfully pull the required data from it and read this data on connected computer. In a previous post, I was able to display a cube that moved randomly using this data. I recently found the issue; I had been interpreting an acceleration directly as a displacement (distance) which had resulted in seemingly random data with a magnitude similar to what I might have expected.</span>
			</p>
			<p>
				<span>With this fixed, I have been able to get the cube in the Processing program to rotate in the same direction the Arduino and IMU, though the movement doesn't slow down. I recorded a video of this which is in the GitHub project.</span>
			</p>
		</div>

		<div>
			<p>
				<h2>Further progress with the data</h2>
			</p>
			<p class="date">
				5/7/2021	4:42PM
			</p>
			<p>
			    <span>I have now fully implemented the Euler angle version of the two programs which correctly represent the rotation with in the limits of Euler angles. As such, the demo still suffers from gimble lock, which is an inherent part of using Euler angles. This version also has a demonstration video on the GitHub.</span>
			</p>
			<p>
				<span>Solving this will require an implementation of Quaternions, which I had hoped would not be necessary as they will add significant complexity to the code.</span>
			</p>
		</div>

		<div>
			<p>
				<h2>Finalised the data processing</h2>
			</p>
			<p class="date">
				5/7/2021	4:45PM
			</p>
			<p>
				<span>I have finished implementing and testing the Quaterion implementation and am satified with the results I have seen. I have also added a servo to the system to test the Arduino's ability to control one. This required the use of an external power supply, though this could be easily replaced with a battery for the original intended implementation. A demonstration of the final prototype is also available on the GitHub page.</span>
			</p>
			<p>
				<span>The process of implementing Quaternions ended up being much simpler than expected, mostly due to the large number of well written sources I was able to find.</span>
			</p>
		</div>
	</body>
</html>